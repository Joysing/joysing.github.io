<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<title>疫苗预约查询</title>
	<link rel="shortcut icon" type="image/x-icon" href="./favicon.ico">
	<link rel="stylesheet" href="./dist/themes/default/style.min.css" />
	<link rel="stylesheet" href="./zupu.css?v=4" />
	<link  rel="stylesheet" href="./dist/bootstrap-5.3.0-alpha1-dist/css/bootstrap.min.css">
	<script src="./dist/bootstrap-5.3.0-alpha1-dist/js/bootstrap.bundle.min.js"></script>

</head>
<body>

	<nav class="navbar navbar-dark bg-primary">
	  <div class="container-fluid">
		<a class="navbar-brand">查询结果</a>
	  </div>
	</nav>
	<div class="container-fluid" style="margin-top:1.3em;">
		<!-- <hr class="border border-primary border-2 opacity-75"> -->

		<div id="content" class="row" style="margin-left: 10px;">
			<ul class="list-group">
			  <li class="list-group-item">姓名：张懿琳</li>
			  <li class="list-group-item">身份证：441702200108112224</li>
			  <li class="list-group-item">联系电话：13664983861</li>
			  <li class="list-group-item">疫苗类型：HPV</li>
			  <li class="list-group-item">接种时间：2023年8月18日</li>
			  <li class="list-group-item">接种单位：香港综合肿瘤中心</li>
			  <li class="list-group-item">接种地点：香港特别行政区中环花园道3号HK香港岛冠君大厦4楼</li>
			</ul>
		</div>
	</div>
	<br>
	<br>
	<footer class="border-top footer text-muted text-center mb-3">
        <div class="container">
            &copy; 2023 - 香港综合肿瘤中心<br>
        </div>
    </footer>
	<script src="./dist/libs/jquery-3.6.4.min.js"></script>
	<script src="./dist/jstree.js"></script>
	
	<script>
	////拖动按钮改变DIV大小
	$(function () {
		var target = document.querySelector('#ajaxParent');

		//初始化参数
		var els = target.style,
		//鼠标的 X 和 Y 轴坐标
		x = y = 0;
		//绑定需要拖拽改变大小的元素对象 -----pc端---
		bindResize(document.getElementById("moveButton"),target);

		//  移动端拖拽 -------------------
		// 手指按下
		document.getElementById("moveButton").addEventListener('touchstart', function (e) {
			x = e.targetTouches[0].pageX - target.offsetWidth,
			y = e.targetTouches[0].pageY - target.offsetHeight;
			e.preventDefault()
		});
		document.getElementById("moveButton").addEventListener('touchmove', function (e) {
			//左右拖动改变宽度
			//els.width = e.targetTouches[0].pageX - x + 'px'
			//上下拖动改变高度
			els.height = e.targetTouches[0].pageY - y + 'px'
		});
    });

    function bindResize(moveButton,el) {
		var els = el.style,
        //鼠标的 X 和 Y 轴坐标
        x = y = 0;
		//鼠标按下事件
		$(moveButton).mousedown(function (e) {
			//按下元素后，计算当前鼠标与对象计算后的坐标
			x = e.clientX - el.offsetWidth,
			y = e.clientY - el.offsetHeight;
			//在支持 setCapture 做些东东
			el.setCapture ? (
				//捕捉焦点
				el.setCapture(),
				//设置事件
				el.onmousemove = function (ev) {
					mouseMove(ev || event)
				},
				el.onmouseup = mouseUp
			) : (
				//绑定事件
				$(document).bind("mousemove", mouseMove).bind("mouseup", mouseUp)
			)
			//防止默认事件发生
			e.preventDefault()
		});

		//移动事件
		function mouseMove(e) {
			//左右拖动改变宽度
			//els.width = e.clientX - x + 'px'
			//上下拖动改变高度
			els.height = e.clientY - y + 'px'
		}

		//停止事件
		function mouseUp() {
			//在支持 releaseCapture 做些东东
			el.releaseCapture ? (
				//释放焦点
				el.releaseCapture(),
				//移除事件
				el.onmousemove = el.onmouseup = null
			) : (
				//卸载事件
				$(document).unbind("mousemove", mouseMove).unbind("mouseup", mouseUp)
			)
		}
    }
	////拖动按钮改变DIV大小



	var filePath="3.json";
	loadTree("#ajax1","1.json");
	loadTree("#ajax2","2.json");
	loadTree("#ajax3","3.json");
	document.getElementById("ajax3").style.display = 'block';
	function loadTree(treeDivID,jsonFilePath){
		$(treeDivID).on("select_node.jstree", function (e, data) {
			nodeId=data.node.id;
			$.getJSON(jsonFilePath, function(data) {
				
				//data 代表读取到的json中的数据
				$.each(data, function(infoIndex, info) {
					if(nodeId==info["id"])
						$("#description").html(info["description"]);
				});
			});
		})
		.on('search.jstree', function (event,data) {
			if (data.res.length>0) {
				$(treeDivID).jstree(true).select_node(data.res[0]);
				//滚动
				$('#ajaxParent').animate({scrollTop: 0,scrollLeft: 0}, 100);
				$('#ajaxParent').animate({
					scrollTop: $('#'+data.res[0]).offset().top-$('#ajaxParent')[0].offsetHeight/2,
					scrollLeft: $('#'+data.res[0]).offset().left}, 100);
			}else{
				//显示提示toast
				var searchToast = new bootstrap.Toast(document.getElementById('searchToast'))
				searchToast.show()
			}
		})
		.jstree({
			'core' : {
				'data' : {
					"url" : jsonFilePath,
					"dataType" : "json" // needed only if you do not supply JSON headers
				},
				"themes" : {
					"variant" : "large",//加大
					"ellipsis" : true //文字多时省略
				}
			}
			,
			"types" : {
				"#" : {
					"max_children" : -1,
					"max_depth" : 2,
					"icon" : "personicon",//自定义css类personicon
					"valid_children" : ["root"]
				},
				"man" : {
					"icon" : "personicon",
					"valid_children" : []
				}
			},
			
			"plugins" : ["search", "state", "types", "wholerow", "themes","sort"]
		});
	}
	//查找功能
	function searchButtonClick(){  
		var searchInput=$('#searchInput').val();
		if(document.getElementById("ajax1").style.display == 'block')
			$("#ajax1").jstree(true).search(searchInput);
		else if(document.getElementById("ajax2").style.display == 'block')
			$("#ajax2").jstree(true).search(searchInput);
		else if(document.getElementById("ajax3").style.display == 'block')
			$("#ajax3").jstree(true).search(searchInput);
	} 
	
	const triggerTabList = document.querySelectorAll('#list-tab a')
	triggerTabList.forEach(triggerEl => {
	  const tabTrigger = new bootstrap.Tab(triggerEl)
	  triggerEl.addEventListener('click', event => {
		if(event.srcElement.id=="list1"){
			document.getElementById("ajax1").style.display = 'block';
			document.getElementById("ajax2").style.display = 'none';
			document.getElementById("ajax3").style.display = 'none';
		}else if(event.srcElement.id=="list2"){
			document.getElementById("ajax1").style.display = 'none';
			document.getElementById("ajax2").style.display = 'block';
			document.getElementById("ajax3").style.display = 'none';
		}else if(event.srcElement.id=="list3"){
			document.getElementById("ajax1").style.display = 'none';
			document.getElementById("ajax2").style.display = 'none';
			document.getElementById("ajax3").style.display = 'block';
		}
		
	  })
	})
	
	document.getElementById("content").style.display = 'block';
	document.getElementById("pdfContent").style.display = 'none';
	document.querySelectorAll('#page-tab a').forEach(triggerEl => {
	  const tabTrigger = new bootstrap.Tab(triggerEl)
	  triggerEl.addEventListener('click', event => {
		if(event.srcElement.id=="page1"){
			document.getElementById("content").style.display = 'block';
			document.getElementById("pdfContent").style.display = 'none';
			document.getElementById("searchInput").setAttribute("placeholder","名字");
			document.getElementById("searchInput").disabled=""
			document.getElementById("searchButton").disabled=""
		}else if(event.srcElement.id=="page2"){
			document.getElementById("content").style.display = 'none';
			document.getElementById("pdfContent").style.display = 'block';
			document.getElementById("searchInput").setAttribute("placeholder","用下面放大镜查找");
			document.getElementById("searchInput").disabled="disabled"
			document.getElementById("searchButton").disabled="disabled"
		}
		
	  })
	})


	</script>
</body>
</html>
